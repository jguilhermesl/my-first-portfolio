/*! 20220309-3-RELEASE */

!function(){const t={ctaAnchorWidth:100,ctaAnchorMarginRight:2,ctaAnchorMarginLeft:2},e=72,i=4,n=2,a=8,o="10px",r=.1,s=10,l=.98,d=TRC.dom.createHTMLElement("canvas");class c{constructor(t,e){this.itemContainer=t,this.rbox=t.rbox,this.ctaData=e,this.labelsBox=t.labelsBox,c.styleInjected||c.injectCallToActionStyle()}static injectCallToActionStyle(){const e=`${t.ctaAnchorWidth}px`,i=`${t.ctaAnchorMarginRight}px`,n=`${t.ctaAnchorMarginLeft}px`;TRC.dom.injectStyle(`div.videoCube a.video-cta-style { width: 100%; } div.videoCube a.video-cta-style span.video-label-box.video-label-box-cta { display: flex; flex-wrap: wrap; align-content: flex-start; } div.videoCube a.video-cta-style span.video-label-box.video-label-box-cta.video-label-box-cta-non-ie { justify-content: space-between; } div.videoCube a.video-cta-style span.video-label-flex-cta-item { flex-basis: 100%; } div.videoCube a.video-cta-style span.video-branding-flex-cta-item { flex-grow: 1; flex-basis: 1px; } div.videoCube a.video-cta-style span.video-branding-flex-cta-item-no-stream { margin-top: 5px; } div.videoCube a.video-cta-style a.video-cta-href { display: inline-block; margin: 5px 2px 0px 2px; padding: 0; min-width: 72px; bottom: 0; vertical-align: top; position: relative; box-sizing: content-box; align-self: start; order: 2; flex-shrink: 0; font-size: 10px; line-height: 13.2px; } div.videoCube a.video-cta-style a.video-cta-href button.video-cta-button { margin: 0; height: 24px; font-size: 10px; line-height: 13.2px; border-radius: 4px; border: 1px solid; background-color: inherit; border-color: #999999; text-transform: none; letter-spacing: normal; box-sizing: border-box; font-weight: 400; cursor: pointer; outline: none; font-family: Helvetica; padding: 1px 4px; width: 100%; min-width: 1px; opacity: 1; box-shadow: none; user-select: none; transition: none; text-decoration: none; transform: none; } div.videoCube a.video-cta-style a.video-cta-href button.video-cta-button:hover { color: inherit; border-color: inherit; background-color: inherit; letter-spacing: normal; } div.videoCube a.video-cta-style span.video-branding-flex-cta-rating { flex-basis: 100%; padding-bottom: 2px; padding-top: 2px; margin-top: 5px; direction: ltr; } div.videoCube a.video-cta-style span.video-branding-flex-cta-rating span.video-branding-flex-cta-oval-wrapper { margin-left: 6px; margin-right: 6px; } div.videoCube a.video-cta-style span.video-branding-flex-cta-rating span.video-branding-flex-cta-oval-wrapper svg.cta-rating-oval { vertical-align: middle; margin-bottom: 1px; height: 3px; width: 3px; } div.videoCube a.video-cta-style span.video-branding-flex-cta-rating span.video-branding-flex-cta-price-wrapper { font-family: Helvetica Bold; font-size: 10px; color: #737373; } div.videoCube a.video-cta-style span.video-branding-flex-cta-rating svg.cta-rating-star { margin-right: 4px; height: 9px; width: 9px; }div.videoCube a.video-cta-style.non-feed-cta-item span.video-branding-flex-cta-item-no-stream { margin-top: 3px; }div.videoCube a.video-cta-style.non-feed-cta-item a.video-cta-href { margin-top: 0px; min-width: 68px; }`,null),c.styleInjected=!0}renderCTAButton(t,e){const i=this.rbox.ctaData;if(!i||!i.hasCTAItem)return;if(!this.ctaData.shouldRenderAsCTA&&!i.shouldAdjustAllItemsHeight)return;const n=this.itemContainer.querySelector(".video-label-box");if(!n)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_no_videoLabelBox_list_suffix");if(this.itemContainer.rbox.container.querySelector(".story-widget"))return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filterd_item_in_reco_reel_story_widget_list_suffix");const a=n.querySelector(".branding");if(a&&this.ctaData.shouldRenderAsCTA&&this.ctaData.isPriceRating&&this.renderPriceRatingSection(n,a),i.shouldAdjustAllItemsHeight&&(t.maxDesiredHeight=Math.max(t.maxDesiredHeight,TRC.CTAManager.getDesiredVideoBoxHeight(n,a,this.ctaData,this.rbox))),!a)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_no_branding_list_suffix");const o=a.getBoundingClientRect();if(o&&o.width>0){const t=parseFloat(TRC.CTAManager.getComputedStyleProp(a,"margin-left",0))/o.width;if(t>r)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_high_margin_left_list_suffix");const e=parseFloat(TRC.CTAManager.getComputedStyleProp(a,"margin-right",0))/o.width;if(e>r)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_high_margin_right_list_suffix");if(TRC.ctaManager.shouldReport){this.ctaData.brandingHeightBefore=o.height;const t=n.getBoundingClientRect();if(t){if(!window.TRCImpl.direction||"ltr"===window.TRCImpl.direction){const e=(o.left-t.left)/t.width;e<.15&&(this.ctaData.brandingDirection="ltr",this.ctaData.brandingLocation=e)}if("rtl"===window.TRCImpl.direction){const e=(t.right-o.right)/t.width;e<.15&&(this.ctaData.brandingDirection="rtl",this.ctaData.brandingLocation=e)}}}}const d=TRC.CTAManager.getComputedStyleProp(n,"height"),g=TRC.CTAManager.getComputedStyleProp(n,"max-height");if(t.maxDesiredHeight>g)TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_videoLabelBox_smaller_than_max_height_list_suffix");else{if(d){const t=TRC.CTAManager.getVideoLabelBoxChildrenWithoutButtonHeight(n);if(d+s<t)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_videoLabelBox_smaller_than_children_list_suffix")}if(this.ctaData.shouldRenderAsCTA){const i=TRC.CTAManager.getComputedStyleProp(a,"position");if(i&&"absolute"===i)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_branding_absolute_position_list_suffix");const o=a.querySelector("div.logoDiv");if(o){const t=TRC.CTAManager.getComputedStyleProp(o,"position");if(t&&"absolute"===t)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_branding_logo_div_inner_absolute_position_list_suffix")}const r=this.getMaxWidthForBranding(n,a)||0,s=this.getBrandingWidth(a);if(s>=r)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_large_branding_width_list_suffix");const d=c.getBrandingPartsWidth(a)||0;if(d>=r)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_large_branding_parts_width_list_suffix");const g=TRC.CTAManager.getComputedStyleProp(n,"boxSizing",null);if(!g||"border-box"!==g){const t=n.getBoundingClientRect();if(t&&t.width>0){const e=parseFloat(TRC.CTAManager.getComputedStyleProp(n,"width",0))/t.width;if(e>l){const t=TRC.CTAManager.getComputedStyleProp(n,"paddingLeft",0),e=TRC.CTAManager.getComputedStyleProp(n,"paddingRight",0);if(t>0||e>0)return void TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_padding_on_full_width_list_suffix")}}}t.shouldAdjustHeight=!0,this.drawCTAButton(n,a),n.classList.contains("video-label-box-cta")&&this.handleCtaResponsiveStyle(e)}}}drawCTAButton(t,e){TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"rendered");const i=this.createCtaAnchorElement(e);this.addCtaToDom(i,t,e),this.addClickMetricToCTA(i.ctaButton),this.ctaData.renderedCtaButton=!0}createCtaAnchorElement(t){const{itemContainer:e,ctaData:i}=this,n=TRC.dom.createHTMLElement("a"),a=this.createCtaButton(t);return n.classList.add("video-cta-href"),n.target="_blank",n.rel="nofollow noopener",n.href=this.createAnchorHref(),n.ctaButton=a,c.setCtaButtonStyle(e,i,a),n.appendChild(a),n}createCtaButton(t){const e=TRC.dom.createHTMLElement("button");return e.type="button",e.classList.add("video-cta-button","video-cta-style"),e.innerText=this.ctaData.actionText,c.setStyleFromElement(t,e,"color"),c.setStyleFromElement(t,e,"font-family"),e}createAnchorHref(){return`${this.itemContainer.link.logger_url}&cta=true`}addCtaToDom(t,e,i){const{itemContainer:n}=this,a=this.isLinkDirectsToLabelLink(n)?n.link:this.getLabelLink();a&&a.classList.add("video-cta-style"),!n.rbox.isFeedCard&&a&&a.classList.add("non-feed-cta-item"),e.classList.add("video-label-box-cta"),!TRC.Browser.ie&&e.classList.add("video-label-box-cta-non-ie");const o=e.querySelectorAll(".video-label");if(o)for(let r=0;r<o.length;r++){const t=o[r];t.classList.add("video-label-flex-cta-item")}this.updateBrandingStyling(t,i),e.appendChild(t)}addClickMetricToCTA(t){const{itemContainer:e,ctaData:i}=this;t.onclick=function(){TRC.ctaManager.sendEvent(e,i,"cta_button_clicked")}}isLinkDirectsToLabelLink(t){const e=this.getLabelLink();return!e||!t.link||t.link===e}getLabelLink(){return this.itemContainer.querySelector(".item-label-href")}handleBrandingFlexItemOrder(t,e){if(t.classList.add("video-branding-flex-cta-item"),this.rbox.ctaData.isStream){const i=TRC.CTAManager.getComputedStyleProp(t,"margin-top");i?e.style.marginTop=`${i+1}px`:t.classList.add("video-branding-flex-cta-item-no-stream")}else t.classList.add("video-branding-flex-cta-item-no-stream");t.style.order=1}static setCtaButtonStyle(t,e,i){if(Object.keys(TRC.ctaManager.options.style).forEach(t=>{TRC.ctaManager.options.style[t]&&(i.style[t]=TRC.ctaManager.options.style[t])}),!TRC.ctaManager.options.isInheritTitleColor)return;const n=t.querySelector(".video-title"),a=TRC.CTAManager.getComputedStyleProp(n,"color");a.indexOf("rgb(0, 0, 0)")<0&&TRC.ctaManager.sendEvent(t,e,"CTA_Title_Not_Black"),c.setStyleFromElement(n,i,"color"),c.setStyleFromElement(n,i,"border-color")}static setStyleFromElement(t,e,i){if(!e||!t)return;const n=TRC.CTAManager.getComputedStyleProp(t,i);n&&(e.style[i]=n)}static getBrandingPartsWidth(t){const e=t.querySelector(".branding-inner"),i=t.querySelector(".branding-separator"),n=t.querySelector(".logoDiv"),a=e&&TRC.dom.getOuterWidth(e)||0,o=i&&TRC.dom.getOuterWidth(i)||0,r=n&&TRC.dom.getOuterWidth(n)||0;return a+o+r}updateBrandingStyling(t,e){e&&this.handleBrandingFlexItemOrder(e,t)}renderPriceRatingSection(t,e){TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"renderedPriceRating");const i=this.createPriceRatingSection();t.insertBefore(i,e)}createPriceRatingSection(){const t=TRC.dom.createHTMLElement("span");if(t.classList.add("video-branding-flex-cta-rating"),this.ctaData.price){const e=TRC.dom.createHTMLElement("span");e.innerText=this.ctaData.price,e.classList.add("video-branding-flex-cta-price-wrapper"),t.appendChild(e)}if(this.ctaData.price&&this.ctaData.rating){const e=TRC.dom.createHTMLElement("span");e.classList.add("video-branding-flex-cta-oval-wrapper");const i=c.createSvgOval();e.insertAdjacentHTML("beforeend",i),t.appendChild(e)}if(this.ctaData.rating){const{cardIndex:e}=this.ctaData,i=TRC.dom.createHTMLElement("span");for(let t=0;t<5;t++){const n=Math.min(Math.max(this.ctaData.rating-t,0),1),a=c.createSvgStar(e,t,n);i.insertAdjacentHTML("beforeend",a)}i.classList.add("video-branding-flex-cta-stars-wrapper"),t.appendChild(i)}return t}static createSvgStar(t,e,i){return`${'<svg class="cta-rating-star" height="9px" version="1.1" viewBox="0 0 9 9" width="9px" xmlns="http://www.w3.org/2000/svg">'+'    <g fill="none" fill-rule="evenodd" stroke="none" stroke-width="1">'+'        <linearGradient id="lg'}${e}-${t}" x1="0" x2="1" y1="0.5" y2="0.5">`+`            <stop offset="0" stop-color="#737373" stop-opacity="1"/>`+`            <stop offset="${i}" stop-color="#737373" stop-opacity="1"/>`+`            <stop offset="${i}" stop-color="#737373" stop-opacity="0.5"/>`+`            <stop offset="1" stop-color="#737373" stop-opacity="0.5"/>`+`        </linearGradient>`+`        <g fill="url(#lg${e}-${t})" fill-rule="nonzero" transform="translate(-21.000000, -19.000000)">`+`            <polygon points="25.5 26.4626165 22.7188471 28 23.25 24.7437694 21 22.4376941 24.1094235 21.9626165 25.5 19 26.8905765 21.9626165 30 22.4376941 27.75 24.7437694 28.2811529 28"></polygon>`+`        </g>`+`    </g>`+`</svg>`}static createSvgOval(){return'<svg class="cta-rating-oval"  width="3px" height="3px" viewBox="0 0 3 3" version="1.1" xmlns="http://www.w3.org/2000/svg">'+'    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">'+'        <g transform="translate(-172.000000, -485.000000)" fill="#666666" fill-rule="nonzero">'+'            <circle cx="173.5" cy="486.5" r="1.5"></circle>'+"        </g>"+"    </g>"+"</svg>"}getBrandingWidth(t){const e=TRC.CTAManager.getComputedStyleProp(t,"font-weight"),i=TRC.CTAManager.getComputedStyleProp(t,"font-size"),n=TRC.CTAManager.getComputedStyleProp(t,"font-family"),a=this.getPseudoElWidth(t,":before"),o=this.getPseudoElWidth(t,":after"),r=this.measureText(this.itemContainer.video_data["branding-text"],e,i,n)||0;return a+r+o}getPseudoElWidth(t,e){let i=0;const n=window.getComputedStyle(t,e,this.itemContainer),a=n&&"none"!==n.content;return a&&(TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"has_pseudo_el"),i=this.calcPseudoElWidth(n)),i}calcPseudoElWidth(t){let e=parseInt(t.width,10);const i=t.content;return isNaN(e)&&i.length>0&&(e=this.measureText(i,t.fontWeight,t.fontSize,t.fontFamily),TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"has_text_pseudo_el")),e}getMaxWidthForBranding(t,r){const s=TRC.CTAManager.getComputedStyleProp(this.getEffectiveTitleElement(t),"width"),l=TRC.ctaManager.options.style.fontWeight||"400",d=this.measureText(this.ctaData.actionText,l,o,TRC.CTAManager.getComputedStyleProp(r,"font-family"))||0,c=Math.max(e,d);return s-c-i-n-a}measureText(t,e,i,n){try{if(null==t||""===t)return null;if(null==i&&(null==n||""===n))return null;if(null==d)return TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"measureText_no_canvas"),null;const a=d.getContext("2d");if(null==a)return TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"measureText_no_canvas_context"),null;const o=[];if(null!=e&&o.push(e.toString()),null!=i&&o.push(`${parseInt(i,10)}px`),null!=n&&o.push(n),0===o.length)return TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"measureText_no_font_parts"),null;const r=o.join(" ");if(null==r||""===r)return TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"measureText_empty_font_value"),null;a.font=r;const s=a.measureText(t);return null==s?(TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"measureText_no_metrics"),null):s.width}catch(t){return TRC.ctaManager.sendEvent(this.itemContainer,this.ctaData,"filtered_error_measure_text_list_suffix"),null}}getEffectiveTitleElement(t){return this.rbox.ctaData.isStream&&t.querySelector(".video-label")||t}handleCtaResponsiveStyle(t){const{itemContainer:e}=this;if(t.fixResponsiveBoxTitleAndDesc(e),window.TRC.dom.on(window,"resize",()=>{t.fixResponsiveBoxTitleAndDesc(e)}),e.video_data){const i=t.getDetailSpansFromLabelsBoxes("branding",e);i.length&&setTimeout(()=>{for(let n=0;n<i.length;n++)t.fixBoxOverflow(i[n],e.video_data["branding-text"],!0,!0)},0)}}static areRectsInterset(t,e,i,n){const a=t.getBoundingClientRect(),o=e.getBoundingClientRect();return 0===a.width||0===a.height||0===o.width||0===o.height?null:a.left>o.right||a.right<o.left||a.top>o.bottom||a.bottom<o.top?null:`${i}_intersects_with_${n}`}static isLocationChanged(t,e,i,n,a,o){if(null==a||!o)return null;const r=t.getBoundingClientRect(),s=e.getBoundingClientRect();if(r&&s){if("ltr"===o){const t=(r.left-s.left)/s.width;if(t>a+.1)return`${i}_moved_from_left`}if("rtl"===o){const t=(s.right-r.right)/s.width;if(t>a+.1)return`${i}_moved_from_right`}}return null}static isLargerThanElement(t,e,i,n,a){const o=TRC.ctaManager.getHeightOfElementIncludeMargin(t),r=TRC.ctaManager.getHeightOfElementIncludeMargin(e);return o-r>a?`${i}_is_larger_by_${a}_than_${n}`:null}static isLargeElement(t,e,i,n){const a=t.getBoundingClientRect();return a.height>i?`${e}_${n}_large`:null}static isElementExists(t,e){return t?null:`${e}_not_exists`}static isElementVisible(t,e){return"none"===TRC.CTAManager.getComputedStyleProp(t,"display","unknown")?`${e}_display_none`:null}static isAboveOrBelow(t,e,i,n){const a=t.getBoundingClientRect(),o=e.getBoundingClientRect();return a.top>o.bottom?`${i}_below_${n}`:a.bottom<o.top?`${i}_above_${n}`:null}static isRectNotFullyContainedInRect(t,e,i,n){const a=c.isAboveOrBelow(t,e,i,n);if(a)return a;const o=t.getBoundingClientRect(),r=e.getBoundingClientRect();return o.left<r.left?`${i}_left_border_outside_of_${n}`:o.right>r.right?`${i}_right_border_outside_of_${n}`:o.bottom>r.bottom?`${i}_bottom_border_outside_of_${n}`:o.top<r.top?`${i}_top_border_outside_of_${n}`:null}reportBack(t,e){if(!TRC.ctaManager.shouldReport)return;if(!e.renderedCtaButton)return;let i=!1;window.TRC.dom.on(window,"scroll",()=>{if(!i)try{if(!this.rbox.isInViewPort(t,0))return;if(i)return;i=!0,setTimeout(()=>{try{TRC.ctaManager.sendEvent(t,e,"visible","report");const i=t.querySelector(".video-label-box"),n=i?i.querySelector(".video-cta-href"):null,a=n?n.querySelector(".video-cta-button"):null,o=i?i.querySelector(".branding"):null,r=c.isElementExists(i,"videoLabelBox")||c.isElementExists(n,"ctaAnchor")||c.isElementExists(a,"ctaButton")||c.isElementExists(o,"branding")||c.isElementVisible(n,"ctaAnchor")||c.isElementVisible(a,"ctaButton")||c.isRectNotFullyContainedInRect(n,t,"ctaAnchor","videoCube")||c.isRectNotFullyContainedInRect(n,i,"ctaAnchor","videoLabelBox")||c.isRectNotFullyContainedInRect(a,n,"ctaButton","ctaAnchor")||c.isAboveOrBelow(n,o,"ctaAnchor","branding")||c.areRectsInterset(n,o,"ctaAnchor","branding")||c.isLargeElement(a,"ctaButton",TRC.CTAManager.getButtonInnerHeight()+5,"too")||c.isLargeElement(n,"ctaAnchor",TRC.CTAManager.getButtonInnerHeight()+5,"too")||c.isLargerThanElement(n,o,"ctaAnchor","branding",4)||c.isLargerThanElement(o,n,"branding","ctaAnchor",4)||c.isLocationChanged(o,i,"branding","videoLabelBox",e.brandingLocation,e.brandingDirection)||c.isLargeElement(o,"branding",1.9*e.brandingHeightBefore,"became");r&&TRC.ctaManager.sendEvent(t,e,r,"report")}catch(i){TRC.ctaManager.sendEvent(t,e,"error_reporting_with_timeout","report",i.message)}},3e3)}catch(i){TRC.ctaManager.sendEvent(t,e,"error_reporting","report",i.message)}})}}TRC.CallToActionComponent=c}();